# Dockerfile.test-e2e
FROM node:20-slim

# Install Playwright with Chromium and all dependencies
RUN npx playwright install --with-deps chromium

# Create app directory
WORKDIR /app/tests

# Copy package files and install dependencies
COPY package*.json ./
RUN npm install

# Copy the rest of the app
COPY . .

EXPOSE 3000

# Default command can be overridden by docker-compose
# CMD [ "npm", "run", "test-docker:e2e" ]
CMD ["xvfb-run", "--auto-servernum", "npx", "playwright", "test", "--headed"]
